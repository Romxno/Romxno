name: Generate DevOps Cloud AI Dashboard

on:
  schedule:
    - cron: "0 */6 * * *"
  workflow_dispatch:

permissions:
  contents: write

jobs:
  dashboard:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v4

      - name: Generate modern dashboard SVG
        run: |
          mkdir -p dist
          python3 << 'EOF'
          from datetime import datetime
          import random

          now = datetime.utcnow().strftime("%Y-%m-%d %H:%M UTC")

          cicd = [random.randint(40, 90) for _ in range(10)]
          bars = "".join(
              f'<rect x="{40+i*22}" y="{110-v}" width="14" height="{v}" rx="4"/>'
              for i, v in enumerate(cicd)
          )

          svg = f'''
          <svg width="900" height="360" viewBox="0 0 900 360"
            xmlns="http://www.w3.org/2000/svg">

          <style>
            .bg {{ fill:#0b1220; }}
            .panel {{ fill:#111827; stroke:#1f2933; stroke-width:1; }}
            .title {{ fill:#22c55e; font-family:Inter,monospace; font-size:18px; font-weight:700; }}
            .label {{ fill:#94a3b8; font-family:Inter,monospace; font-size:13px; }}
            .metric {{ fill:#e5e7eb; font-family:monospace; font-size:14px; }}
            .green {{ fill:#22c55e; }}
            .blue {{ fill:#38bdf8; }}
            .purple {{ fill:#a855f7; }}
          </style>

          <rect width="100%" height="100%" rx="16" class="bg"/>

          <!-- Header -->
          <text x="30" y="36" class="title">‚öôÔ∏è DevOps ‚Ä¢ ‚òÅÔ∏è Cloud ‚Ä¢ ü§ñ AI Dashboard</text>
          <text x="30" y="60" class="label">Status: üü¢ Healthy</text>
          <text x="680" y="60" class="label">Updated: {now}</text>

          <!-- CI/CD Panel -->
          <rect x="30" y="80" rx="14" ry="14" width="260" height="220" class="panel"/>
          <text x="50" y="110" class="label">CI/CD Pipeline Health</text>
          <g class="green">{bars}</g>
          <text x="50" y="290" class="metric">Deploy trend: ‚Üë Stable</text>

          <!-- Cloud Panel -->
          <rect x="320" y="80" rx="14" ry="14" width="260" height="220" class="panel"/>
          <text x="340" y="110" class="label">Cloud Operations</text>
          <text x="340" y="150" class="metric blue">‚òÅ AWS ‚Ä¢ Kubernetes</text>
          <text x="340" y="180" class="metric">Cost: Optimized</text>
          <text x="340" y="210" class="metric">Availability: 99.9%</text>

          <!-- AI Panel -->
          <rect x="610" y="80" rx="14" ry="14" width="260" height="220" class="panel"/>
          <text x="630" y="110" class="label">AI / GenAI Focus</text>
          <text x="630" y="150" class="metric purple">ü§ñ LLMs & Agents</text>
          <text x="630" y="180" class="metric">Use-cases: Automation</text>
          <text x="630" y="210" class="metric">Learning: Active</text>

          </svg>
          '''

          open("dist/devops-cloud-ai-dashboard.svg", "w").write(svg)
          EOF

      - name: Publish dashboard
        uses: crazy-max/ghaction-github-pages@v4
        with:
          target_branch: output
          build_dir: dist
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
